/** handorgel v0.4.3, @license MIT */
function e(e){return void 0===e}function t(t,n){var i=Object.getOwnPropertyDescriptor(t,n);return e(t[n])||i&&i.writable}function n(e){for(var n=void 0,i=arguments,s=1;s<i.length;++s)if(n=i[s])for(var o in n)t(e,o)&&(e[o]=n[o]);return e}var i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=function(e,t){return t={exports:{}},e(t,t.exports),t.exports}(function(e){!function(t,n){e.exports?e.exports=n():t.EvEmitter=n()}("undefined"!=typeof window?window:i,function(){"use strict";function e(){}var t=e.prototype;return t.on=function(e,t){if(e&&t){var n=this._events=this._events||{},i=n[e]=n[e]||[];return-1==i.indexOf(t)&&i.push(t),this}},t.once=function(e,t){if(e&&t){this.on(e,t);var n=this._onceEvents=this._onceEvents||{};return(n[e]=n[e]||{})[t]=!0,this}},t.off=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){var i=n.indexOf(t);return-1!=i&&n.splice(i,1),this}},t.emitEvent=function(e,t){var n=this._events&&this._events[e];if(n&&n.length){n=n.slice(0),t=t||[];for(var i=this._onceEvents&&this._onceEvents[e],s=0;s<n.length;s++){var o=n[s];i&&i[o]&&(this.off(e,o),delete i[o]),o.apply(this,t)}return this}},t.allOff=function(){delete this._events,delete this._onceEvents},e})}),o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,a=(function(){function e(e){this.value=e}function t(t){function n(s,o){try{var a=t[s](o),r=a.value;r instanceof e?Promise.resolve(r.value).then(function(e){n("next",e)},function(e){n("throw",e)}):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":s.resolve({value:t,done:!0});break;case"throw":s.reject(t);break;default:s.resolve({value:t,done:!1})}(s=s.next)?n(s.key,s.arg):o=null}var s,o;this._invoke=function(e,t){return new Promise(function(i,a){var r={key:e,arg:t,resolve:i,reject:a,next:null};o?o=o.next=r:(s=o=r,n(e,t))})},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},h=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},d={},u={button:{"aria-controls":function(){return this.id+"-content"},"aria-expanded":function(){return this.expanded?"true":"false"},"aria-disabled":function(){return this.disabled?"true":"false"}},content:{role:function(){return"region"},"aria-labelledby":function(){return this.id+"-header"}}},c={arrowDown:40,arrowUp:38,pageUp:33,pageDown:34,end:35,home:36},f=function(){function e(t,n,i){a(this,e),n.handorgelFold||(this.handorgel=t,this.header=n,this.button=n.firstElementChild,this.content=i,this.header.handorgelFold=this,this.content.handorgelFold=this,d[this.handorgel.id]||(d[this.handorgel.id]=0),this.id=this.handorgel.id+"-fold"+ ++d[this.handorgel.id],this.header.setAttribute("id",this.id+"-header"),this.content.setAttribute("id",this.id+"-content"),this.focused=!1,this.expanded=!1,this.disabled=!1,this._listeners={},this._bindEvents(),this._initAria(),this._initialOpen(),this._initialFocus())}return r(e,[{key:"open",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.expanded||(this.handorgel.emitEvent("fold:open",[this]),this.expanded=!0,this.handorgel.options.collapsible||this.disable(),this._updateAria("button","aria-expanded"),this.header.classList.add(this.handorgel.options.headerOpenClass),this.content.classList.add(this.handorgel.options.contentOpenClass),this.resize(e),e||this._opened())}},{key:"close",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.expanded&&(this.handorgel.emitEvent("fold:close",[this]),this.expanded=!1,this.handorgel.options.collapsible||this.enable(),this._updateAria("button","aria-expanded"),this.header.classList.remove(this.handorgel.options.headerOpenedClass),this.content.classList.remove(this.handorgel.options.contentOpenedClass),this.resize(e),e||this._closed())}},{key:"disable",value:function(){this.disabled=!0,this._updateAria("button","aria-disabled"),this.header.classList.add(this.handorgel.options.headerDisabledClass),this.content.classList.add(this.handorgel.options.contentDisabledClass)}},{key:"enable",value:function(){this.disabled=!1,this._updateAria("button","aria-disabled"),this.header.classList.remove(this.handorgel.options.headerDisabledClass),this.content.classList.remove(this.handorgel.options.contentDisabledClass)}},{key:"focus",value:function(){this.button.focus()}},{key:"blur",value:function(){this.button.blur()}},{key:"toggle",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.expanded?this.close(e):this.open(e)}},{key:"resize",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=0;t||(this.header.classList.add(this.handorgel.options.headerNoTransitionClass),this.content.classList.add(this.handorgel.options.contentNoTransitionClass)),this.expanded&&(n=this.content.firstElementChild.offsetHeight),this.content.style.height=n+"px",t||o(function(){e.header.classList.remove(e.handorgel.options.headerNoTransitionClass),e.content.classList.remove(e.handorgel.options.contentNoTransitionClass)})}},{key:"destroy",value:function(){this._unbindEvents(),this._cleanAria(),this.header.classList.remove(this.handorgel.options.headerOpenClass),this.header.classList.remove(this.handorgel.options.headerOpenedClass),this.header.classList.remove(this.handorgel.options.headerFocusClass),this.header.classList.remove(this.handorgel.options.headerNoTransitionClass),this.content.classList.remove(this.handorgel.options.contentOpenClass),this.content.classList.remove(this.handorgel.options.contentOpenedClass),this.content.classList.remove(this.handorgel.options.contentFocusClass),this.content.classList.remove(this.handorgel.options.contentNoTransitionClass),this.content.style.height="0px",this.header.handorgelFold=null,this.content.handorgelFold=null,this.header.removeAttribute("id"),this.content.removeAttribute("id"),this.handorgel=null}},{key:"_opened",value:function(){this.header.classList.add(this.handorgel.options.headerOpenedClass),this.content.classList.add(this.handorgel.options.contentOpenedClass),this.handorgel.emitEvent("fold:opened",[this])}},{key:"_closed",value:function(){this.header.classList.remove(this.handorgel.options.headerOpenClass),this.content.classList.remove(this.handorgel.options.contentOpenClass),this.handorgel.emitEvent("fold:closed",[this])}},{key:"_initialOpen",value:function(){var e=this;null===this.header.getAttribute(this.handorgel.options.initialOpenAttribute)&&null===this.content.getAttribute(this.handorgel.options.initialOpenAttribute)||(this.handorgel.options.initialOpenTransition?window.setTimeout(function(){e.open()},this.handorgel.options.initialOpenTransitionDelay):this.open(!1))}},{key:"_initialFocus",value:function(){null!==this.button.getAttribute("autofocus")&&this._handleFocus()}},{key:"_initAria",value:function(){this._updateAria("button"),this._updateAria("content")}},{key:"_cleanAria",value:function(){this._updateAria("button",null,!0),this._updateAria("content",null,!0)}},{key:"_updateAria",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.handorgel.options.ariaEnabled)if(t){var i=u[e][t].call(this);this[e].setAttribute(t,i)}else for(var s in u[e])if(u[e].hasOwnProperty(s))if(n)this[e].removeAttribute(s);else{var o=u[e][s].call(this);this[e].setAttribute(s,o)}}},{key:"_handleContentTransitionEnd",value:function(e){e.target===e.currentTarget&&"height"===e.propertyName&&(this.handorgel.resize(!0),this.expanded?this._opened():this._closed())}},{key:"_handleFocus",value:function(){this.focused=!0,this.header.classList.add(this.handorgel.options.headerFocusClass),this.content.classList.add(this.handorgel.options.contentFocusClass),this.handorgel.emitEvent("fold:focus",[this])}},{key:"_handleBlur",value:function(){this.focused=!1,this.header.classList.remove(this.handorgel.options.headerFocusClass),this.content.classList.remove(this.handorgel.options.contentFocusClass),this.handorgel.emitEvent("fold:blur",[this])}},{key:"_handleButtonClick",value:function(e){this.focus(),this.disabled||this.toggle()}},{key:"_handleButtonKeydown",value:function(e){if(this.handorgel.options.keyboardInteraction){var t=null;switch(e.which){case c.arrowDown:t="next";break;case c.arrowUp:t="prev";break;case c.home:t="first";break;case c.end:t="last";break;case c.pageDown:e.ctrlKey&&(t="next");break;case c.pageUp:e.ctrlKey&&(t="prev")}t&&(e.preventDefault(),this.handorgel.focus(t))}}},{key:"_handleContentKeydown",value:function(e){if(this.handorgel.options.keyboardInteraction&&e.ctrlKey){var t=null;switch(e.which){case c.pageDown:t="next";break;case c.pageUp:t="prev"}t&&(e.preventDefault(),this.handorgel.focus(t))}}},{key:"_bindEvents",value:function(){this._listeners={bFocus:["focus",this.button,this._handleFocus.bind(this)],bBlur:["blur",this.button,this._handleBlur.bind(this)],bClick:["click",this.button,this._handleButtonClick.bind(this)],bKeydown:["keydown",this.button,this._handleButtonKeydown.bind(this)],cKeydown:["keydown",this.content,this._handleContentKeydown.bind(this)],cTransition:["transitionend",this.content,this._handleContentTransitionEnd.bind(this)]};for(var e in this._listeners)if(this._listeners.hasOwnProperty(e)){var t=this._listeners[e];t[1].addEventListener(t[0],t[2])}}},{key:"_unbindEvents",value:function(){for(var e in this._listeners)if(this._listeners.hasOwnProperty(e)){var t=this._listeners[e];t[1].removeEventListener(t[0],t[2])}}}]),e}(),p=0,v=function(e){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t);var s=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handorgel?h(s):(s.element=e,s.element.handorgel=s,s.id="handorgel"+ ++p,s.element.setAttribute("id",s.id),s.folds=[],s.options=n({},t.defaultOptions,i),s._listeners={},s._resizing=!1,s._bindEvents(),s._initAria(),s.update(),s)}return l(t,s),r(t,[{key:"update",value:function(){this.folds=[];for(var e=this.element.children,t=0,n=e.length;t<n;t+=2){var i=e[t],s=e[t+1],o=i.handorgelFold;o||(o=new f(this,i,s)),this.folds.push(o)}}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.folds.forEach(function(t){t.resize(e)}),this._resizing=!1}},{key:"focus",value:function(e){for(var t=this.folds.length,n=null,i=0;i<t&&null===n;i++)this.folds[i].focused&&(n=i);if("prev"!==e&&"next"!==e||null!==n||(e="prev"===e?"last":"first"),"prev"===e&&0===n){if(!this.options.carouselFocus)return;e="last"}if("next"===e&&n===t-1){if(!this.options.carouselFocus)return;e="first"}switch(e){case"prev":this.folds[--n].focus();break;case"next":this.folds[++n].focus();break;case"last":this.folds[t-1].focus();break;case"first":default:this.folds[0].focus()}}},{key:"destroy",value:function(){this.emitEvent("destroy"),this.element.removeAttribute("id"),this.folds.forEach(function(e){e.destroy()}),this._unbindEvents(),this._cleanAria(),this.element.handorgel=null,this.emitEvent("destroyed")}},{key:"_handleFoldOpen",value:function(e){this.options.multiSelectable||this.folds.forEach(function(t){e!==t&&t.close()})}},{key:"_handleResize",value:function(){var e=this;this._resizing||(this._resizing=!0,o(function(){e.resize()}))}},{key:"_initAria",value:function(){this.options.ariaEnabled&&(this.element.setAttribute("role","presentation"),this.options.multiSelectable&&this.element.setAttribute("aria-multiselectable","true"))}},{key:"_cleanAria",value:function(){this.element.removeAttribute("role"),this.element.removeAttribute("aria-multiselectable")}},{key:"_bindEvents",value:function(){this._listeners.resize=this._handleResize.bind(this),window.addEventListener("resize",this._listeners.resize),this._listeners.foldOpen=this._handleFoldOpen.bind(this),this.on("fold:open",this._listeners.foldOpen)}},{key:"_unbindEvents",value:function(){window.removeEventListener("resize",this._listeners.resize),this.off("fold:open",this._listeners.foldOpen)}}]),t}();v.defaultOptions={keyboardInteraction:!0,multiSelectable:!0,ariaEnabled:!0,collapsible:!0,carouselFocus:!0,initialOpenAttribute:"data-open",initialOpenTransition:!0,initialOpenTransitionDelay:200,headerOpenClass:"handorgel__header--open",contentOpenClass:"handorgel__content--open",headerOpenedClass:"handorgel__header--opened",contentOpenedClass:"handorgel__content--opened",headerDisabledClass:"handorgel__header--disabled",contentDisabledClass:"handorgel__content--disabled",headerFocusClass:"handorgel__header--focus",contentFocusClass:"handorgel__content--focus",headerNoTransitionClass:"handorgel__header--notransition",contentNoTransitionClass:"handorgel__content--notransition"};export default v;